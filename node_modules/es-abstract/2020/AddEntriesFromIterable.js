'use strict';

var inspect = require('object-inspect');

var GetIntrinsic = require('get-intrinsic');

var $TypeError = GetIntrinsic('%TypeError%');

var Call = require('./Call');
var Get = require('./Get');
var GetIterator = require('./GetIterator');
var IsCallable = require('./IsCallable');
var IteratorClose = require('./IteratorClose');
var IteratorStep = require('./IteratorStep');
var IteratorValue = require('./IteratorValue');
var Type = require('./Type');

// https://262.ecma-international.org/10.0//#sec-add-entries-from-iterable

module.exports = function AddEntriesFromIterable(target, iterable, adder) ***REMOVED***
	if (!IsCallable(adder)) ***REMOVED***
		throw new $TypeError('Assertion failed: `adder` is not callable');
	***REMOVED***
	if (iterable == null) ***REMOVED***
		throw new $TypeError('Assertion failed: `iterable` is present, and not nullish');
	***REMOVED***
	var iteratorRecord = GetIterator(iterable);
	while (true) ***REMOVED*** // eslint-disable-line no-constant-condition
		var next = IteratorStep(iteratorRecord);
		if (!next) ***REMOVED***
			return target;
		***REMOVED***
		var nextItem = IteratorValue(next);
		if (Type(nextItem) !== 'Object') ***REMOVED***
			var error = new $TypeError('iterator next must return an Object, got ' + inspect(nextItem));
			return IteratorClose(
				iteratorRecord,
				function () ***REMOVED*** throw error; ***REMOVED*** // eslint-disable-line no-loop-func
			);
		***REMOVED***
		try ***REMOVED***
			var k = Get(nextItem, '0');
			var v = Get(nextItem, '1');
			Call(adder, target, [k, v]);
		***REMOVED*** catch (e) ***REMOVED***
			return IteratorClose(
				iteratorRecord,
				function () ***REMOVED*** throw e; ***REMOVED***
			);
		***REMOVED***
	***REMOVED***
***REMOVED***;
