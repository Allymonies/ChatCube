'use strict';

var keys = require('object-keys');
var hasSymbols = typeof Symbol === 'function' && typeof Symbol('foo') === 'symbol';

var toStr = Object.prototype.toString;
var concat = Array.prototype.concat;
var origDefineProperty = Object.defineProperty;

var isFunction = function (fn) ***REMOVED***
	return typeof fn === 'function' && toStr.call(fn) === '[object Function]';
***REMOVED***;

var arePropertyDescriptorsSupported = function () ***REMOVED***
	var obj = ***REMOVED******REMOVED***;
	try ***REMOVED***
		origDefineProperty(obj, 'x', ***REMOVED*** enumerable: false, value: obj ***REMOVED***);
		// eslint-disable-next-line no-unused-vars, no-restricted-syntax
		for (var _ in obj) ***REMOVED*** // jscs:ignore disallowUnusedVariables
			return false;
		***REMOVED***
		return obj.x === obj;
	***REMOVED*** catch (e) ***REMOVED*** /* this is IE 8. */
		return false;
	***REMOVED***
***REMOVED***;
var supportsDescriptors = origDefineProperty && arePropertyDescriptorsSupported();

var defineProperty = function (object, name, value, predicate) ***REMOVED***
	if (name in object && (!isFunction(predicate) || !predicate())) ***REMOVED***
		return;
	***REMOVED***
	if (supportsDescriptors) ***REMOVED***
		origDefineProperty(object, name, ***REMOVED***
			configurable: true,
			enumerable: false,
			value: value,
			writable: true
		***REMOVED***);
	***REMOVED*** else ***REMOVED***
		object[name] = value;
	***REMOVED***
***REMOVED***;

var defineProperties = function (object, map) ***REMOVED***
	var predicates = arguments.length > 2 ? arguments[2] : ***REMOVED******REMOVED***;
	var props = keys(map);
	if (hasSymbols) ***REMOVED***
		props = concat.call(props, Object.getOwnPropertySymbols(map));
	***REMOVED***
	for (var i = 0; i < props.length; i += 1) ***REMOVED***
		defineProperty(object, props[i], map[props[i]], predicates[props[i]]);
	***REMOVED***
***REMOVED***;

defineProperties.supportsDescriptors = !!supportsDescriptors;

module.exports = defineProperties;
