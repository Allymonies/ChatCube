'use strict';

var test = require('tape');
var inspect = require('object-inspect');
var hasBigInts = require('has-bigints')();
var hasSymbols = require('has-symbols')();
var hasToStringTag = require('has-tostringtag/shams')();

var isBigInt = require('../');

var debug = function (v, m) ***REMOVED*** return inspect(v) + ' ' + m; ***REMOVED***;

var forEach = function (arr, func) ***REMOVED***
	var i;
	for (i = 0; i < arr.length; ++i) ***REMOVED***
		func(arr[i], i, arr);
	***REMOVED***
***REMOVED***;

test('non-BigInt values', function (t) ***REMOVED***
	var nonBigInts = [
		true,
		false,
		Object(true),
		Object(false),
		null,
		undefined,
		***REMOVED******REMOVED***,
		[],
		/a/g,
		'string',
		42,
		new Date(),
		function () ***REMOVED******REMOVED***,
		NaN
	];
	if (hasSymbols) ***REMOVED***
		nonBigInts.push(Symbol.iterator, Symbol('foo'));
	***REMOVED***
	t.plan(nonBigInts.length);
	forEach(nonBigInts, function (nonBigInt) ***REMOVED***
		t.equal(false, isBigInt(nonBigInt), debug(nonBigInt, 'is not a BigInt'));
	***REMOVED***);
	t.end();
***REMOVED***);

test('faked BigInt values', function (t) ***REMOVED***
	t.test('real BigInt valueOf', ***REMOVED*** skip: !hasBigInts ***REMOVED***, function (st) ***REMOVED***
		var fakeBigInt = ***REMOVED*** valueOf: function () ***REMOVED*** return BigInt(42); ***REMOVED*** ***REMOVED***;
		st.equal(false, isBigInt(fakeBigInt), 'object with valueOf returning a BigInt is not a BigInt');
		st.end();
	***REMOVED***);

	t.test('faked @@toStringTag', ***REMOVED*** skip: !hasBigInts || !hasToStringTag ***REMOVED***, function (st) ***REMOVED***
		var fakeBigInt = ***REMOVED*** valueOf: function () ***REMOVED*** return BigInt(42); ***REMOVED*** ***REMOVED***;
		fakeBigInt[Symbol.toStringTag] = 'BigInt';
		st.equal(false, isBigInt(fakeBigInt), 'object with fake BigInt @@toStringTag and valueOf returning a BigInt is not a BigInt');

		var notSoFakeBigInt = ***REMOVED*** valueOf: function () ***REMOVED*** return 42; ***REMOVED*** ***REMOVED***;
		notSoFakeBigInt[Symbol.toStringTag] = 'BigInt';
		st.equal(false, isBigInt(notSoFakeBigInt), 'object with fake BigInt @@toStringTag and valueOf not returning a BigInt is not a BigInt');
		st.end();
	***REMOVED***);

	var fakeBigIntString = ***REMOVED*** toString: function () ***REMOVED*** return '42n'; ***REMOVED*** ***REMOVED***;
	t.equal(false, isBigInt(fakeBigIntString), 'object with toString returning 42n is not a BigInt');

	t.end();
***REMOVED***);

test('BigInt support', ***REMOVED*** skip: !hasBigInts ***REMOVED***, function (t) ***REMOVED***
	forEach([
		Function('return 42n')(), // eslint-disable-line no-new-func
		BigInt(42),
		Object(BigInt(42))
	], function (bigInt) ***REMOVED***
		t.equal(true, isBigInt(bigInt), debug(bigInt, 'is a BigInt'));
	***REMOVED***);

	t.end();
***REMOVED***);
